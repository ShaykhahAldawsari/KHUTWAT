import streamlit as st
import numpy as np
import pickle

st.markdown(
    """
    <style>
        body {
            direction: rtl;
            text-align: right;
        }
        .css-1d391kg { /* Sidebar */
            direction: rtl;
            text-align: right;
            position: fixed;
            right: 0;
            left: auto;
        }
        .css-1kyxreq { /* Main content block */
            direction: rtl;
            text-align: right;
        }
    </style>
    """,
    unsafe_allow_html=True,
)

questions = [
    "๐ ุฃุญุจ ุฃููู ูุญูุฑ ุงูุงูุชุจุงู ูู ุงูุญููุงุช.",
    "๐ฌ ูุง ุฃุชููู ูุซูุฑ ูุฃููู ููุณููุช.",
    "๐ค ุฃุฑุชุงุญ ุฅุฐุง ููุช ุญูู ุงููุงุณ.",
    "๐ถ๏ธ ุฃูุถู ุฃุฌูุณ ูู ุงูุฎูููุฉ ุจุนูุฏ ุนู ุงูุงูุชุจุงู.",
    "๐ฌ ุฏุงูู ุฃุจุฏุฃ ุงููุญุงุฏุซุงุช ุจููุณู.",
    "๐ค ูุง ูููู ุนูุฏู ููุงู ูุซูุฑ ุฃุญูุงููุง.",
    "๐ฅ ุฃุญุจ ุฃุชููู ูุน ูุงุณ ูุฎุชูููู ูู ุงูุญููุงุช.",
    "๐ซฅ ูุง ุฃุญุจ ุฃููุช ุงูุงูุชุจุงู ูููุณู.",
    "๐ ุนุงุฏู ุนูุฏู ุฃููู ูุญูุฑ ุงูุงูุชูุงู.",
    "๐ค ุฃููู ูุงุฏุฆ ุฅุฐุง ููุช ูุน ูุงุณ ูุง ุฃุนุฑููู.",
    "๐ฐ ุฃุชูุชุฑ ุจุณุฑุนุฉ ูู ุจุนุถ ุงูููุงูู.",
    "๐งโโ๏ธ ุฃุบูุจ ุงูููุช ุฃููู ูุณุชุฑุฎู ูุฑุงูู.",
    "๐ ุฃููู ูุซูุฑ ุนูู ุงูุฃููุฑ ุงููู ุชูููู.",
    "๐ ูุงุฏุฑูุง ูุง ุฃุญุณ ุจุงููุขุจุฉุ ูุฃููู ููุชูุงุคู.",
    "๐ ุฃููู ุญุณุงุณ ุชุฌุงู ุจุนุถ ุงูุฃููุฑ.",
    "๐ก ุฃุชูุชุฑ ูุฃุนุตุจ ุจุณุฑุนุฉ.",
    "๐ญ ูุฒุงุฌู ูุชุบูุฑ ูุซูุฑ ูุจุณุฑุนุฉ.",
    "๐ช๏ธ ุนูุฏู ุชููุจุงุช ูุฒุงุฌูุฉ ูุชูุฑุฑุฉ.",
    "๐ ุฃุญูุงููุง ุฃุนุตุจ ุจุณุฑุนุฉ.",
    "๐ ุบุงูุจูุง ุฃุญุณ ุจุงููุขุจุฉ.",
    "๐ถ ูุง ุฃูุชู ูุซูุฑ ุจูุดุงุนุฑ ุงูุขุฎุฑูู.",
    "๐ค ุฃุญุจ ุฃูุชู ุจุงููุงุณ ูุฃุณุงุนุฏูู.",
    "๐ฃ๏ธ ุฃุญูุงููุง ุฃุณูุก ูููุงุณ ุจุฏูู ูุตุฏ.",
    "๐ค ุฃุชุนุงุทู ูุน ูุดุงุนุฑ ุงูุขุฎุฑูู.",
    "๐โโ๏ธ ูุง ุฃูุชู ุจูุดุงูู ุงูุขุฎุฑูู ุฃุญูุงููุง.",
    "๐ ููุจู ุทูุจ ูุฃุญุจ ุฃุณุงุนุฏ ุบูุฑู.",
    "๐ ูุง ุฃููู ููุชู ุจุงููุงุณ ูู ุงูููุช.",
    "โณ ุฏุงูู ุฃุฎุตุต ููุช ูููุงุณ ุงููู ุฃูุฏุฑูู.",
    "๐ซ ุฃุญุณ ุจูุดุงุนุฑ ุงูุขุฎุฑูู ูุฃููููู.",
    "๐ ุฃุญุจ ุฃุฑูุญ ุงููู ุญููู ูุฃุฎูููู ูุฑุชุงุญูู.",
    "๐๏ธ ุฏุงูู ุฃููู ูุณุชุนุฏ ููู ุดูุก.",
    "๐ฆ ุฃุญูุงููุง ุฃุฎูู ุฃุบุฑุงุถู ูุจุนุซุฑุฉ.",
    "๐ ุฃุญุจ ุฃุฏูู ูู ุงูุชูุงุตูู.",
    "๐งน ุฃุญูุงููุง ุฃูุดู ุฃุฑุชุจ ุฃููุฑู.",
    "๐ ุฃุญุจ ุฃูุฌุฒ ุดุบูู ุจุณุฑุนุฉ ูุจุฏูู ุชุฃุฎูุฑ.",
    "๐๏ธ ุฃูุณู ุฃุฑุฌุน ุงูุฃุดูุงุก ููุงููุง ุฃุญูุงููุง.",
    "๐ ุฃุญุจ ุงููุธุงู ูุงุฑุชุจ ูู ุดูุก.",
    "๐ ุฃุญูุงููุง ุฃุชูุฑุจ ูู ุจุนุถ ุงููุณุคูููุงุช.",
    "๐ ุฏุงูู ุฃูุชุฒู ุจุฌุฏููู.",
    "๐ฏ ุฃุญุจ ุฃููู ุฏููู ูู ุดุบูู.",
    "๐ ุนูุฏู ููุฑุฏุงุช ุบููุฉ ูุฃุญุจ ุฃุชุนูู ูููุงุช ุฌุฏูุฏุฉ.",
    "๐ง ุฃุญูุงููุง ูููู ุตุนุจ ุนูู ุฃููู ุงูุฃููุงุฑ ุงููุฌุฑุฏุฉ.",
    "๐ ุนูุฏู ุฎูุงู ูุงุณุน ูุฃุญุจ ุงูุฃููุงุฑ ุงูุฅุจุฏุงุนูุฉ.",
    "๐ญ ูุง ุฃูุชู ูุซูุฑ ุจุงูุฃููุงุฑ ุงููุฌุฑุฏุฉ.",
    "๐ก ุนูุฏู ุฃููุงุฑ ุฑุงุฆุนุฉ ูุฃุญุจ ุฃุดุงุฑููุง.",
    "๐ ูุง ุฃูุชูู ุฎูุงู ูุงุณุน ุฏุงุฆููุง.",
    "โก ุฃููู ุงูุฃููุฑ ุจุณุฑุนุฉ ูุฃุณุชูุนุจูุง ุจุณูููุฉ.",
    "๐ ุฃุญุจ ุฃุณุชุฎุฏู ูููุงุช ูุนุจุฑุฉ ุฃุญูุงููุง.",
    "๐ค ุฃุญุจ ุฃููุฑ ูุฃุชุฃูู ูู ุงูุฃุดูุงุก ุงููู ุชูููู.",
    "๐จ ุฏุงูู ุนูุฏู ุฃููุงุฑ ุฌุฏูุฏุฉ ูุฃุญุจ ุงูุฅุจุฏุงุน."
]


options = [
    "ุฃุนุชุฑุถ ุจููุฉ",
    "ุฃุนุชุฑุถ",
    "ูุญุงูุฏ",
    "ุฃูุงูู",
    "ุฃูุงูู ุจููุฉ"
]
# these were inferred from the clusters (anaylized muliple rows)
cluster_descriptions = { 
    0: "ูุง ุณูุงูุ ุดููู ุชุญุจ ุงูุงููุชุงุญ ูุงูุชุนุจูุฑ ุนู ููุณูุ ูุน ููุณุฉ ูู ุงูุญุณุงุณูุฉ ูุงูุชูููุฑ ุงูุฅุจุฏุงุนู. ุชุญุจ ุงูุชูุงุตูู ุงูุฏูููุฉ ูุชุชููุฒ ุจุงูุงูุชุฒุงูุ ุฑุบู ุฃูู ุชููู ุฃุญูุงููุง ููุชูุชุฑ. ุดุฎุตูุชู ุชุธูุฑ ูููุง ูุฒูุฌ ูู ุงูุฌุฑุฃุฉ ูุงูุงูุถุจุงุทุ ููุง ูุฌุนู ููู ุดุฎุตูุง ููุชุฌูุง ูู ุจูุฆุงุช ุชุนุชูุฏ ุนูู ุงูุฅุจุฏุงุน ูุงูุฌูุฏ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูู ุชูุธูู ุญุณุงุณูุชู ูุงููุชุงุญู ูู ูุฌุงูุงุช ุชูุฏุฑ ูููุง ุงูุงุจุชูุงุฑ ูุงูุชูุธูู! ๐จ๐",
    1: "ูุงุถุญ ุฅูู ุดุฎุต ุงุฌุชูุงุนู ููุบุงูุฑ! ุนูุฏู ูุฏุฑุฉ ุนูู ุงูุญูุงุธ ุนูู ูุฏูุฆู ุญุชู ูู ุฃุตุนุจ ุงูุธุฑููุ ููุน ุฐูู ุชุญุจ ุชููู ูู ูุณุท ุงูุฃุญุฏุงุซ ูุชุณุชูุชุน ุจุงุณุชูุดุงู ุฃุดูุงุก ุฌุฏูุฏุฉ. ุดุฎุตูุชู ุชุนูุณ ุฑูุญ ุงููุบุงูุฑุฉ ูุงูุงููุชุงุญุ ูุงููุงุณ ุฏุงูู ูุญุณูู ุจุงูุทุงูุฉ ุงูุฅูุฌุงุจูุฉ ููุง ูููููู ุญููู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชูุฏ ูู ูุฏุฑุชู ุนูู ุงูุชุฃููู ูุฌุฑูุจ ุฃุฏูุงุฑ ุชุชุทูุจ ุงูุดุฌุงุนุฉ ูุงูุงููุชุงุญ ุนูู ุงูุขุฎุฑูู! ๐๐ฃ๏ธ",
    2: "ุดุฎุตูุชู ูุชูุงุฒูุฉ ูุนูููุฉุ ูุน ููุณุฉ ูู ุงูุงุณุชูุฑุงุฑ ุงูุนุงุทูู. ุชุญุจ ุชุจูู ุฃููุงุฑ ุฌุฏูุฏุฉุ ูุชุชุตุฑู ุจุชูููุฑ ููุฏูุก. ุงููุงุณ ูุซููู ููู ูุฃูู ูุชูุงุฒู ููุฑู. ุฃูุช ูู ุงูุฃุดุฎุงุต ุงููู ูุญุจูู ุจูุงุก ุงูุนูุงูุงุชุ ููู ุจุทุฑููุฉ ููุธูุฉ ููุฏุฑูุณุฉ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุบู ุชูุงุฒูู ูุชููู ูุงุฆุฏูุง ูุนุชูุฏ ุนููู ูู ุงูููุงูู ุงููุฎุชููุฉ! ๐๏ธ๐ค",
    3: "ุฃูุช ุดุฎุต ููุธู ูุนููู ุฌุฏูุงุ ุชุญุจ ุฅูุฌุงุฒ ุงูููุงู ุจุฏูุฉ ูุชูุชู ุจุงูุชูุงุตูู. ููุน ุฐููุ ุชููู ุฌุงูุจูุง ุงุฌุชูุงุนููุง ูุฌุนู ุงููุงุณ ููุฌุฐุจูู ุฅููู. ุงููุงุณ ูุดููููู ูุดุฎุต ูุนุชูุฏ ุนูููุ ุฎุตูุตูุง ููุง ูุชุนูู ุงูุฃูุฑ ุจุฅูุฌุงุฒ ุงููุดุงุฑูุน ุงูุตุนุจุฉ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุฎุฏู ุทุงูุชู ููููุงุฏุฉ ูุชูุธูู ุงููุดุงุฑูุน! ๐ผ๐ฏ",
    4: "ุดุฎุตูุชู ุชููู ููุชูููุฑ ูุงูุชุญูููุ ูุน ุจุนุถ ุงูุชุฑุฏุฏ ูู ุงูุงูุฎุฑุงุท ุงูุงุฌุชูุงุนู. ุญุณุงุณูุชู ุงูุนุงููุฉ ุชุนูุณ ุนูู ุชูููุฑู ูุญุฑุตู. ุฃุญูุงููุง ุชููู ููุชูููุฑ ุงูุฒุงูุฏุ ููู ูุงูุดู ูุฏู ุนูู ูุนูู ูุญุฑุตู ุนูู ุงุชุฎุงุฐ ุงููุฑุงุฑุงุช ุงูุตุญ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูู ุชูุชุญ ููุณู ุฃูุซุฑ ูููุงุณ ููู ุฌุฑูุฆูุง ูู ุงูุชุนุจูุฑ ุนู ุขุฑุงุฆู! ๐ง๐ฌ",
    5: "ูุง ุณูุงู! ุฃูุช ุดุฎุต ูุชูุงุฒู ุฌุฏูุง. ุนูุฏู ุงููููู ูู ูู ุดูุกุ ููุฐุง ูุฎููู ุชุชุฃููู ูุน ุฃู ุจูุฆุฉ ุจุณูููุฉ. ุชุญุจ ุชุจูู ุงูุฃููุฑ ุณูุณุฉ ูุจุณูุทุฉ. ุงููุงุณ ูุญุจููู ูุฃูู ุดุฎุต ูุฑูุญ ููุชูููุ ูุฏุงุฆููุง ุชููู ููุณู ูุณุท ุงููู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุบู ูุฑููุชู ูู ุจูุงุก ุนูุงูุงุช ูููุฉ ููุณุชูุฑุฉ! ๐ค๐",
    6: "ูุงุถุญ ุฅูู ุดุฎุต ุญุณุงุณ ููุชุนุงุทูุ ููุน ุฐูู ููุธู ูููุซูู. ุชุนูู ุจุดูู ุฑุงุฆุน ูุน ุงูุขุฎุฑูู ูุชูุฏุฑ ุฃูููุฉ ุงูุชุนุงูู. ุงููุงุณ ูุดููููู ูุดุฎุต ุฏุงุนู ุฏุงูููุงุ ูุชุญุจ ุชุณุงุนุฏ ุบูุฑู ุญุชู ูู ููุช ูุดุบูู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูุธ ุนูู ุงูุชูุงุฒู ุจูู ุงูุนูู ุงูุฌูุงุนู ูุงูุชูุงูู ุจููุณู! ๐ธ๐๏ธ",
    7: "ุดุฎุตูุชู ุบุงูุถุฉ ููุฎุชููุฉุ ุชููู ูุนุฏู ุงูุงูุฎุฑุงุท ุจุณูููุฉ. ูุฏ ุชููู ููุงุญุธูุง ุฃู ุชุญุจ ุงูุจูุงุก ุจุนูุฏูุง ุนู ุงูุฃุถูุงุก. ุนูุฏู ูุฏุฑุฉ ุนูู ููู ุงูุฃููุฑ ูู ุจุนูุฏุ ูุบุงูุจูุง ุชุญูู ุงููุถุน ูุจู ูุง ุชุชุฎุฐ ุฃู ุฎุทูุฉ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงูุชุญ ุงููุฌุงู ูุงุณุชูุดุงู ุฐุงุชู ุฃูุซุฑุ ูุฏ ุชูุชุดู ุฌูุงูุจ ูุฏูุดุฉ! ๐๐",
    8: "ุดุฎุตูุชู ุชุฌูุน ุจูู ุงูุฅุจุฏุงุน ูุงูุงูุชุฒุงู. ุชุญุจ ุงูุชูููุฑ ุจุทุฑู ุฌุฏูุฏุฉ ูุชูุฏุฑ ุงููุธุงู ูู ุงูููุช ููุณู. ูููู ุงูุงุนุชูุงุฏ ุนููู ูู ุงูุงุจุชูุงุฑ ูุงูุชุทููุฑ. ุงููุงุณ ูุดููููู ูุดุฎุต ูุจุฏุน ูููุฏุฑ ูุฎูู ุฃููุงุฑ ุฎุงุฑุฌ ุงูุตูุฏูู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุฌุฑูุจ ุชุญููู ุฃููุงุฑู ุงูุฅุจุฏุงุนูุฉ ุฅูู ูุดุงุฑูุน ููููุณุฉ! โจ๐ก"
}


# Initialize session state
if "responses" not in st.session_state:
    st.session_state.responses = []
if "current_question" not in st.session_state:
    st.session_state.current_question = 0

# Sidebar
with st.sidebar:
    st.markdown(
        """
        ูุฐุง ุงูุงุฎุชุจุงุฑ ุงูุชูุงุนูู ูููู ุณูุงุช ุดุฎุตูุชู ุจูุงุกู ุนูู:
        -  Extroversion 
        -  Agreeableness 
        -  Conscientiousness 
        -  Neuroticism 
        -  Openness 
        
        ุฌุงูุจ ุจุตุฏู ุนูุดุงู ุชุนุฑู ููุท ุดุฎุตูุชู!
        """
    )

current_index = st.session_state.current_question
total_questions = len(questions)

if current_index < total_questions:
    # Progress bar
    st.progress(current_index / total_questions)

    # Current question
    st.subheader(questions[current_index])

    # Display buttons in rows
    for i, option in enumerate(options, start=1):
        if st.button(option, key=f"option_{current_index}_{i}"):
            st.session_state.responses.append(i)  # Save the response
            st.session_state.current_question += 1  # Move to the next question
else:
    st.header("ูุชุงุฆุฌ ุดุฎุตูุชู")
    st.success("๐ ูููุช ุงูุงุฎุชุจุงุฑ!")

    features = np.array(st.session_state.responses).reshape(1, -1)

    try:
        with open('big5_cluster_model.pkl', 'rb') as file:
            model = pickle.load(file)

        prediction = model.predict(features)

        st.write(f"๐ ุชูุช ูุนุงูุฌุฉ ุฅุฌุงุจุงุชู ุจูุฌุงุญ! ๐")
        st.write(f"{cluster_descriptions[prediction[0]]}")

    except Exception as e:
        st.error(f"ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุฃู ุงุณุชุฎุฏุงู ุงููููุฐุฌ: {e}")

    if st.button("ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ"):
        st.session_state.responses = []
        st.session_state.current_question = 0


