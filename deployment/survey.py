import streamlit as st
import numpy as np
import pickle

st.markdown(
    """
    <style>
        body {
            direction: rtl;
            text-align: right;
        }
        .css-1d391kg { /* Sidebar */
            direction: rtl;
            text-align: right;
            position: fixed;
            right: 0;
            left: auto;
        }
        .css-1kyxreq { /* Main content block */
            direction: rtl;
            text-align: right;
        }
    </style>
    """,
    unsafe_allow_html=True,
)

questions = [
    "๐ ุฃูุง ูุญูุฑ ุงูุงูุชุจุงู ูู ุงูุญููุงุช.",
    "๐ฌ ูุง ุฃุชููู ูุซูุฑ.",
    "๐ค ุฃุดุนุฑ ุจุงูุฑุงุญุฉ ุญูู ุงููุงุณ.",
    "๐ถ๏ธ ุฃูุถู ุงูุจูุงุก ูู ุงูุฎูููุฉ.",
    "๐ฌ ุฃุจุฏุฃ ุงููุญุงุฏุซุงุช.",
    "๐ค ูุง ุนูุฏู ุงููุซูุฑ ูุฃูููู.",
    "๐ฅ ุฃุชููู ูุน ูุงุณ ูุฎุชูููู ูู ุงูุญููุงุช.",
    "๐ซฅ ูุง ุฃุญุจ ููุช ุงูุงูุชุจุงู ูููุณู.",
    "๐ ูุง ุฃูุงูุน ุฃู ุฃููู ูุญูุฑ ุงูุงูุชูุงู.",
    "๐ค ุฃููู ูุงุฏุฆ ุญูู ุงูุบุฑุจุงุก.",
    "๐ฐ ุฃุชูุชุฑ ุจุณูููุฉ.",
    "๐งโโ๏ธ ุฃูุง ูุณุชุฑุฎู ุฃุบูุจ ุงูููุช.",
    "๐ ุฃููู ุจุดุฃู ุงูุฃููุฑ.",
    "๐ ูุงุฏุฑูุง ูุง ุฃุดุนุฑ ุจุงููุขุจุฉ.",
    "๐ ุฃููู ุญุณุงุณ ุชุฌุงู ุงูุฃููุฑ.",
    "๐ก ุฃุชูุชุฑ ุจุณุฑุนุฉ.",
    "๐ญ ูุฒุงุฌู ูุชุบูุฑ ูุซูุฑ.",
    "๐ช๏ธ ุนูุฏู ุชููุจุงุช ูุฒุงุฌูุฉ ูุชูุฑุฑุฉ.",
    "๐ ุฃููู ุณุฑูุน ุงูุบุถุจ.",
    "๐ ุฃุดุนุฑ ุจุงููุขุจุฉ ุบุงูุจูุง.",
    "๐ถ ูุง ุฃุดุนุฑ ุจุงููุซูุฑ ุชุฌุงู ุงูุขุฎุฑูู.",
    "๐ค ุฃูุชู ุจุงููุงุณ.",
    "๐ฃ๏ธ ุฃุณูุก ูููุงุณ.",
    "๐ค ุฃุชุนุงุทู ูุน ูุดุงุนุฑ ุงูุขุฎุฑูู.",
    "๐โโ๏ธ ูุง ุฃูุชู ุจูุดุงูู ุงูุขุฎุฑูู.",
    "๐ ุนูุฏู ููุจ ุฑููู.",
    "๐ ูุง ุฃููู ููุชู ุจุงููุงุณ.",
    "โณ ุฃุฎุตุต ููุช ููุขุฎุฑูู.",
    "๐ซ ุฃุดุนุฑ ุจูุดุงุนุฑ ุงูุขุฎุฑูู.",
    "๐ ุฃุฌุนู ุงููุงุณ ูุดุนุฑูู ุจุงูุฑุงุญุฉ.",
    "๐๏ธ ุฏุงุฆููุง ูุณุชุนุฏ.",
    "๐ฆ ุฃุชุฑู ุฃุบุฑุงุถู ูุจุนุซุฑุฉ.",
    "๐ ุฃุฑูุฒ ุนูู ุงูุชูุงุตูู.",
    "๐งน ุฃูุดู ูู ุชุฑุชูุจ ุงูุฃููุฑ.",
    "๐ ุฃูุฌุฒ ุงูููุงู ุนูู ุงูููุฑ.",
    "๐๏ธ ุฃูุณู ุฅุนุงุฏุฉ ุงูุฃุดูุงุก ุฅูู ููุงููุง.",
    "๐ ุฃุญุจ ุงููุธุงู.",
    "๐ ุฃุชูุฑุจ ูู ูุณุคูููุงุชู.",
    "๐ ุฃูุชุฒู ุจุฌุฏููู.",
    "๐ฏ ุฃููู ุฏููููุง ูู ุนููู.",
    "๐ ุนูุฏู ููุฑุฏุงุช ุบููุฉ.",
    "๐ง ุฃุฌุฏ ุตุนูุจุฉ ูู ููู ุงูุฃููุงุฑ ุงููุฌุฑุฏุฉ.",
    "๐ ุนูุฏู ุฎูุงู ุญู.",
    "๐ญ ูุง ุฃูุชู ุจุงูุฃููุงุฑ ุงููุฌุฑุฏุฉ.",
    "๐ก ุนูุฏู ุฃููุงุฑ ุฑุงุฆุนุฉ.",
    "๐ ูุง ุนูุฏู ุฎูุงู ูุงุณุน.",
    "โก ุฃููู ุงูุฃููุฑ ุจุณุฑุนุฉ.",
    "๐ ุฃุณุชุฎุฏู ูููุงุช ูุนูุฏุฉ.",
    "๐ค ุฃูุถู ุงูููุช ูู ุงูุชูููุฑ ุจุงูุฃุดูุงุก.",
    "๐จ ุฃููู ูููุก ุจุงูุฃููุงุฑ."
]

options = [
    "ุฃุนุชุฑุถ ุจููุฉ",
    "ุฃุนุชุฑุถ",
    "ูุญุงูุฏ",
    "ุฃูุงูู",
    "ุฃูุงูู ุจููุฉ"
]
# these were inferred from the clusters (anaylized muliple rows)
cluster_descriptions = {
    0: "ูุง ุณูุงูุ ุดููู ุชุญุจ ุงูุงููุชุงุญ ูุงูุชุนุจูุฑ ุนู ููุณูุ ูุน ููุณุฉ ูู ุงูุญุณุงุณูุฉ ูุงูุชูููุฑ ุงูุฅุจุฏุงุนู. ุชุญุจ ุงูุชูุงุตูู ุงูุฏูููุฉ ูุชุชููุฒ ุจุงูุงูุชุฒุงูุ ุฑุบู ุฃูู ุชููู ุฃุญูุงููุง ููุชูุชุฑ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูู ุชูุธูู ุญุณุงุณูุชู ูุงููุชุงุญู ูู ูุฌุงูุงุช ุชูุฏุฑ ูููุง ุงูุงุจุชูุงุฑ ูุงูุชูุธูู! ๐จ๐",
    1: "ูุงุถุญ ุฅูู ุดุฎุต ุงุฌุชูุงุนู ููุบุงูุฑ! ุนูุฏู ูุฏุฑุฉ ุนูู ุงูุญูุงุธ ุนูู ูุฏูุฆู ุญุชู ูู ุฃุตุนุจ ุงูุธุฑููุ ููุน ุฐูู ุชุญุจ ุชููู ูู ูุณุท ุงูุฃุญุฏุงุซ ูุชุณุชูุชุน ุจุงุณุชูุดุงู ุฃุดูุงุก ุฌุฏูุฏุฉ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชูุฏ ูู ูุฏุฑุชู ุนูู ุงูุชุฃููู ูุฌุฑูุจ ุฃุฏูุงุฑ ุชุชุทูุจ ุงูุดุฌุงุนุฉ ูุงูุงููุชุงุญ ุนูู ุงูุขุฎุฑูู! ๐๐ฃ๏ธ",
    2: "ุดุฎุตูุชู ูุชูุงุฒูุฉ ูุนูููุฉุ ูุน ููุณุฉ ูู ุงูุงุณุชูุฑุงุฑ ุงูุนุงุทูู. ุชุญุจ ุชุจูู ุฃููุงุฑ ุฌุฏูุฏุฉุ ูุชุชุตุฑู ุจุชูููุฑ ููุฏูุก. ุงููุงุณ ูุซููู ููู ูุฃูู ูุชูุงุฒู ููุฑู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุบู ุชูุงุฒูู ูุชููู ูุงุฆุฏูุง ูุนุชูุฏ ุนููู ูู ุงูููุงูู ุงููุฎุชููุฉ! ๐๏ธ๐ค",
    3: "ุฃูุช ุดุฎุต ููุธู ูุนููู ุฌุฏูุงุ ุชุญุจ ุฅูุฌุงุฒ ุงูููุงู ุจุฏูุฉ ูุชูุชู ุจุงูุชูุงุตูู. ููุน ุฐููุ ุชููู ุฌุงูุจูุง ุงุฌุชูุงุนููุง ูุฌุนู ุงููุงุณ ููุฌุฐุจูู ุฅููู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุฎุฏู ุทุงูุชู ููููุงุฏุฉ ูุชูุธูู ุงููุดุงุฑูุน! ๐ผ๐ฏ",
    4: "ุดุฎุตูุชู ุชููู ููุชูููุฑ ูุงูุชุญูููุ ูุน ุจุนุถ ุงูุชุฑุฏุฏ ูู ุงูุงูุฎุฑุงุท ุงูุงุฌุชูุงุนู. ุญุณุงุณูุชู ุงูุนุงููุฉ ุชุนูุณ ุนูู ุชูููุฑู ูุญุฑุตู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูู ุชูุชุญ ููุณู ุฃูุซุฑ ูููุงุณ ููู ุฌุฑูุฆูุง ูู ุงูุชุนุจูุฑ ุนู ุขุฑุงุฆู! ๐ง๐ฌ",
    5: "ูุง ุณูุงู! ุฃูุช ุดุฎุต ูุชูุงุฒู ุฌุฏูุง. ุนูุฏู ุงููููู ูู ูู ุดูุกุ ููุฐุง ูุฎููู ุชุชุฃููู ูุน ุฃู ุจูุฆุฉ ุจุณูููุฉ. ุชุญุจ ุชุจูู ุงูุฃููุฑ ุณูุณุฉ ูุจุณูุทุฉ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงุณุชุบู ูุฑููุชู ูู ุจูุงุก ุนูุงูุงุช ูููุฉ ููุณุชูุฑุฉ! ๐ค๐",
    6: "ูุงุถุญ ุฅูู ุดุฎุต ุญุณุงุณ ููุชุนุงุทูุ ููุน ุฐูู ููุธู ูููุซูู. ุชุนูู ุจุดูู ุฑุงุฆุน ูุน ุงูุขุฎุฑูู ูุชูุฏุฑ ุฃูููุฉ ุงูุชุนุงูู.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุญุงูุธ ุนูู ุงูุชูุงุฒู ุจูู ุงูุนูู ุงูุฌูุงุนู ูุงูุชูุงูู ุจููุณู! ๐ธ๐๏ธ",
    7: "ุดุฎุตูุชู ุบุงูุถุฉ ููุฎุชููุฉุ ุชููู ูุนุฏู ุงูุงูุฎุฑุงุท ุจุณูููุฉ. ูุฏ ุชููู ููุงุญุธูุง ุฃู ุชุญุจ ุงูุจูุงุก ุจุนูุฏูุง ุนู ุงูุฃุถูุงุก.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุงูุชุญ ุงููุฌุงู ูุงุณุชูุดุงู ุฐุงุชู ุฃูุซุฑุ ูุฏ ุชูุชุดู ุฌูุงูุจ ูุฏูุดุฉ! ๐๐",
    8: "ุดุฎุตูุชู ุชุฌูุน ุจูู ุงูุฅุจุฏุงุน ูุงูุงูุชุฒุงู. ุชุญุจ ุงูุชูููุฑ ุจุทุฑู ุฌุฏูุฏุฉ ูุชูุฏุฑ ุงููุธุงู ูู ุงูููุช ููุณู. ูููู ุงูุงุนุชูุงุฏ ุนููู ูู ุงูุงุจุชูุงุฑ ูุงูุชุทููุฑ.\n\n"
       "ูู ุจุนุทูู ูุตูุญุฉ... ุฌุฑูุจ ุชุญููู ุฃููุงุฑู ุงูุฅุจุฏุงุนูุฉ ุฅูู ูุดุงุฑูุน ููููุณุฉ! โจ๐ก"
}


# Initialize session state
if "responses" not in st.session_state:
    st.session_state.responses = []
if "current_question" not in st.session_state:
    st.session_state.current_question = 0

# Sidebar
with st.sidebar:
    st.markdown(
        """
        ูุฐุง ุงูุงุฎุชุจุงุฑ ุงูุชูุงุนูู ูููู ุณูุงุช ุดุฎุตูุชู ุจูุงุกู ุนูู ุงููููุฐุฌ:
        -  Extroversion 
        -  Agreeableness 
        -  Conscientiousness 
        -  Neuroticism 
        -  Openness 
        
        ุฌุงูุจ ุจุตุฏู ุนูุดุงู ุชุนุฑู ููุท ุดุฎุตูุชู!
        """
    )

current_index = st.session_state.current_question
total_questions = len(questions)

if current_index < total_questions:
    # Progress bar
    st.progress(current_index / total_questions)

    # Current question
    st.subheader(questions[current_index])

    # Display buttons in rows
    for i, option in enumerate(options, start=1):
        if st.button(option, key=f"option_{current_index}_{i}"):
            st.session_state.responses.append(i)  # Save the response
            st.session_state.current_question += 1  # Move to the next question
else:
    st.header("ูุชุงุฆุฌ ุดุฎุตูุชู")
    st.success("๐ ูููุช ุงูุงุฎุชุจุงุฑ!")

    features = np.array(st.session_state.responses).reshape(1, -1)

    try:
        with open('big5_cluster_model.pkl', 'rb') as file:
            model = pickle.load(file)

        prediction = model.predict(features)

        st.write(f"๐ ุชูุช ูุนุงูุฌุฉ ุฅุฌุงุจุงุชู ุจูุฌุงุญ! ๐")
        st.write(f"{cluster_descriptions[prediction[0]]}")

    except Exception as e:
        st.error(f"ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุฃู ุงุณุชุฎุฏุงู ุงููููุฐุฌ: {e}")

    if st.button("ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ"):
        st.session_state.responses = []
        st.session_state.current_question = 0


